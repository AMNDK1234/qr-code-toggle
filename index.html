<!DOCTYPE html>
<html><head>
  <meta charset="utf-8"><title>QR Manager</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>body{font-family:sans-serif;} .qr-item{border:1px solid #ddd; padding:10px; margin:10px}</style>
</head><body>
  <h1>QR Manager</h1>
  <label>Enter Label (e.g., "office" or "personal"):</label><br>
  <input type="text" id="labelInput" placeholder="unique label"><br>
  <label>Enter URL or phone (tel:+...):</label><br>
  <input type="text" id="linkInput"><br><br>
  <button onclick="addQRCode()">Add / Update QR</button>

  <h2>QR Codes List</h2>
  <div id="list"></div>

  <script>
    async function loadStatus() {
      try {
        return await fetch('status.json').then(r=>r.json());
      } catch { return {}; }
    }
    async function saveStatus(obj) {
      alert("Copy this JSON and paste into status.json:\n\n" + JSON.stringify(obj,null,2));
    }

    async function renderList() {
      const status = await loadStatus();
      const listDiv = document.getElementById('list');
      listDiv.innerHTML = '';
      for (const key in status) {
        const cfg = status[key];
        const div = document.createElement('div');
        div.className = 'qr-item';
        div.innerHTML = `<strong>${key}</strong> â€” ${cfg.active?'ðŸŸ¢':'ðŸ”´'}<br>`;
        const qr = document.createElement('div'); div.appendChild(qr);
        new QRCode(qr, { text: window.location.origin + '/redirect.html?label='+encodeURIComponent(key), width:128, height:128 });
        div.innerHTML += `<p>Destination: ${cfg.destination}</p>`;
        listDiv.appendChild(div);
      }
    }

    async function addQRCode(){
      const label = document.getElementById('labelInput').value.trim();
      const link = document.getElementById('linkInput').value.trim();
      if(!label||!link){ alert('Require both!'); return; }
      const status = await loadStatus();
      status[label] = { active: true, destination: link };
      await saveStatus(status);
      await renderList();
    }

    renderList();
  </script>
</body></html>


